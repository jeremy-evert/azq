#!/usr/bin/env bash
# azq â€” Ask ChatGPT from your terminal

set -euo pipefail

if [ -f "./azq_env/bin/activate" ]; then
  source ./azq_env/bin/activate
fi

cmd="${1:-help}"

case "$cmd" in
  ask)
    shift
    exec_mode="false"
    if [[ "${1:-}" == "--exec" ]]; then
      exec_mode="true"
      shift
    fi
    # Use module mode to avoid sys.path hacks
    python -m azq.ask "$exec_mode" "$*"
    ;;

  exec)
    echo "[azq] Executing staged commands (not implemented yet)"
    ;;
  thread-export)
    # ... (leave as-is)
    ;;
  help|--help|-h|"")
    echo "Usage: azq <command> [args]"
    echo "Commands:"
    echo "  ask    'question'   # Ask ChatGPT and log it"
    echo "  exec               # Run staged commands"
    echo "  doc <topic>        # Save Python/pydoc doc for topic"
    echo "  import <id/url>    # Import conversation"
    ;;
  *)
    echo "[azq] Unknown command: $cmd"
    exit 1
    ;;
esac

